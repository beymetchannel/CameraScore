<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>カメラUI＋縦四角50%</title>
<style>
@font-face {
    font-family: 'CyberFont';
    src: url('CyberFont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'DS-DIGIB';
    src: url('DS-DIGIB.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}


body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: black;
    font-family: 'CyberFont', sans-serif;
}

video#camera {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
}

.ui-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

.cyber-border {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    z-index: 2;
    border: 4px solid #0ff;
    box-shadow:
        0 0 20px #0ff,
        0 0 40px #0ff,
        0 0 60px #0ff inset;
    border-radius: 10px;
    animation: glow 2s infinite alternate;
}

@keyframes glow {
    0% { box-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff inset; }
    50% { box-shadow: 0 0 20px #0ff, 0 0 40px #0ff, 0 0 60px #0ff inset; }
    100% { box-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff inset; }
}

/* 左右ブロック */
.left-block, .right-block {
    position: absolute;
    top: 20px;
    display: flex;
    flex-direction: column;
    pointer-events: auto;
}

.left-block { left: 20px; align-items: flex-start; }
.right-block { right: 20px; align-items: flex-end; }

/* プルダウン */
select {
    font-family: 'CyberFont', sans-serif;
    font-weight: bold;
    font-size: 22px; 
    padding: 10px 12px; 
    background: rgba(0,0,0,0.7);
    color: #fff;
    border: 2px solid; 
    border-radius: 8px;
    appearance: none;
    cursor: pointer;
    margin-bottom: 10px;
    width: 35vw; 
    max-width: 35vw;
    box-sizing: border-box;
}

/* 左右で選択ボックスの縁色を変更 */
.left-block select { border-color: #aaffff; } /* 白っぽい青 */
.right-block select { border-color: #ffaaaa; } /* 白っぽい赤ピンク */

/* 四角＋スコア */
.frame-container {
    display: flex;
    flex-direction: column; 
    align-items: center;
}

.right-block .frame-container {
    flex-direction: column; 
    align-items: center;
}

/* 四角のサイズは画面の50%÷4 */
.frame {
    width: 60px;
    height: 10vh; /* 4つで40% */
    border: 3px solid;
    border-radius: 8px 8px 0 0;
    position: relative;
    box-shadow: 0 0 15px, 0 0 30px inset; 
    transition: transform 0.3s, box-shadow 0.3s;
} 

/* 隣接四角の上角丸無効 */
.frame + .frame {
    border-top-left-radius: 0;
    border-top-right-radius: 0;
}

/* 左右の色・光 */
.blue { 
    border-color: #aaffff; 
    box-shadow: 0 0 15px #aaffff, 0 0 30px #aaffff inset; 
}

.pink { 
    border-color: #ffaaaa; 
    box-shadow: 0 0 15px #ffaaaa, 0 0 30px #ffaaaa inset; 
}

/* ホバーで光る */
.frame:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px, 0 0 50px inset;
}

/* スコア */
.score {
    font-family: 'DS-DIGIB', sans-serif;
    font-size: 25vh;
    color: #ffdd99; /* 白っぽい文字色 */
    text-align: center;
    margin-top: 5px;
    text-shadow:
        0 0 10px #ffaa33,
        0 0 20px #ffaa33,
        0 0 40px #ff4400,
        0 0 60px #ff3300;
    animation: neonPulse 1.5s infinite alternate;
}

@keyframes neonPulse {
    0% {
        text-shadow:
            0 0 5px #ffaa33,
            0 0 10px #ffaa33,
            0 0 20px #ff4400,
            0 0 30px #ff3300;
    }
    50% {
        text-shadow:
            0 0 15px #ffaa33,
            0 0 30px #ffaa33,
            0 0 60px #ff4400,
            0 0 90px #ff3300;
    }
    100% {
        text-shadow:
            0 0 10px #ffaa33,
            0 0 20px #ffaa33,
            0 0 40px #ff4400,
            0 0 60px #ff3300;
    }
}
</style>
</head>
<body>

<video id="camera" autoplay playsinline></video>

<div class="cyber-border"></div>

<div class="ui-layer">
    <!-- 左側 -->
    <div class="left-block">
        <select>
            <option>ウィザードロッド3-60B</option>
            <option>ブラストW9-60LR</option>
            <option>シャークスケイル1-60FB</option>
        </select>
        <div class="frame-container">
            <div class="frame blue"></div>
            <div class="frame blue"></div>
            <div class="frame blue"></div>
            <div class="frame blue"></div>
            <div class="score" id="score-left">0</div>
        </div>
    </div>

    <!-- 右側 -->
    <div class="right-block">
        <select>
            <option>ウィザードロッド3-60B</option>
            <option>ブラストW9-60LR</option>
            <option>シャークスケイル1-60FB</option>
        </select>
        <div class="frame-container">
            <div class="frame pink"></div>
            <div class="frame pink"></div>
            <div class="frame pink"></div>
            <div class="frame pink"></div>
            <div class="score" id="score-right">0</div>
        </div>
    </div>
</div>

<script>
// アウトカメラ
navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' }, audio: false })
    .then(stream => { document.getElementById('camera').srcObject = stream; })
    .catch(err => { console.error('カメラ取得エラー:', err); });

// 四角のフレームごとにクリックイベント
function updateScore(container) {
    const scoreEl = container.querySelector('.score');
    const circles = container.querySelectorAll('.cyber-circle').length;
    scoreEl.textContent = circles;

    // score flash
    scoreEl.classList.remove("flash");
    void scoreEl.offsetWidth;
    scoreEl.classList.add("flash");

    // 4点フィニッシュ演出
    if (circles === 4) {
        showFinishEffect(
            container.closest('.left-block') ? "LEFT FINISH!" : "RIGHT FINISH!"
        );
    }
}

function showFinishEffect(text) {
    const flash = document.createElement("div");
    flash.className = "finish-flash";
    flash.textContent = text;
    document.body.appendChild(flash);
    
    setTimeout(() => flash.remove(), 450);
}

document.querySelectorAll('.frame-container').forEach(container => {
    const frames = container.querySelectorAll('.frame');

    frames.forEach(frame => {
        frame.addEventListener('click', () => {
            let circle = frame.querySelector('.cyber-circle');

            if (circle) {
                circle.remove();
                updateScore(container);
                return;
            }

            let target = [...frames].find(f => !f.querySelector('.cyber-circle'));
            if (!target) return;

            circle = document.createElement('div');
            circle.className = 'cyber-circle';

            if(target.classList.contains('blue')){
                circle.style.border = '3px solid #aaffff';
                circle.style.boxShadow = '0 0 20px #aaffff, 0 0 35px #aaffff inset';
            } else {
                circle.style.border = '3px solid #ffaaaa';
                circle.style.boxShadow = '0 0 20px #ffaaaa, 0 0 35px #ffaaaa inset';
            }

            target.appendChild(circle);
            updateScore(container);
        });
    });
});
</script>

<style>
/* 脈打つ円のアニメーション */
@keyframes pulse {
    0% { transform: scale(1); opacity: 0.7; }
    50% { transform: scale(1.3); opacity: 1; }
    100% { transform: scale(1); opacity: 0.7; }
}

/* 円：ゆっくりノイズ明滅（拡大無し） */
.cyber-circle {
    position: absolute;
    width: 55%;
    height: 55%;
    border-radius: 50%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
    animation: noiseSlow 4s infinite steps(5);
}

@keyframes noiseSlow {
    0% { opacity: 0.15; filter: blur(1px); }
    10% { opacity: 0.45; filter: blur(0.5px); }
    25% { opacity: 0.95; filter: blur(0px); }
    40% { opacity: 0.35; filter: blur(1px); }
    60% { opacity: 0.8; filter: blur(0.5px); }
    80% { opacity: 0.25; filter: blur(1.2px); }
    100% { opacity: 0.6; filter: blur(0.3px); }
}



/* スコア光る */
.score.flash {
    animation: scoreFlash 0.25s ease-out;
}

@keyframes scoreFlash {
    0% { transform: scale(1); text-shadow: 0 0 30px #fff, 0 0 60px #ff0; }
    50% { transform: scale(1.25); text-shadow: 0 0 60px #fff, 0 0 100px #ff0; }
    100% { transform: scale(1); text-shadow: 0 0 30px #ffaa33, 0 0 60px #ff3300; }
}

/* フィニッシュ演出 */
.finish-flash {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(3px);
    animation: finishBlink 0.4s ease-out forwards;
    z-index: 99;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'CyberFont';
    color: #0ff;
    text-shadow: 0 0 20px #0ff, 0 0 40px #fff;
    font-size: 8vw;
}

@keyframes finishBlink {
    0% { opacity: 0; }
    20% { opacity: 1; }
    100% { opacity: 0; }
} 
</style>



</body>
</html>
